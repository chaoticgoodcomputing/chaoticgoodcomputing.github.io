var d=Object.defineProperty;var f=(t,e,s)=>e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[e]=s;var o=(t,e,s)=>f(t,typeof e!="symbol"?e+"":e,s);function c(t){let e=new WeakMap;function s(r){let l=e.get(r);l&&(l(),e.delete(r))}function i(){document.querySelectorAll(t.selector).forEach(r=>{s(r);let l=t.initialize(r);l&&e.set(r,l)})}return{start(){document.addEventListener("nav",i),window.addEventListener("load",i),window.addCleanup(()=>{document.removeEventListener("nav",i),window.removeEventListener("load",i)}),i()}}}var a=class{constructor(t,e){o(this,"canvas");o(this,"ctx");o(this,"grid");o(this,"initialGrid",[]);o(this,"rows");o(this,"cols");o(this,"cellSize");o(this,"intervalId",null);o(this,"config");o(this,"resizeObserver",null);this.canvas=t;let s=t.getContext("2d");if(!s)throw new Error("Could not get 2D context");this.ctx=s,this.config=e;let i=e.initialState.length+2*e.verticalPadding;this.cellSize=e.height/i,this.cols=0,this.rows=i,this.grid=[],this.setupResizeObserver(),this.updateDimensions(),this.initializeGrid(),this.saveInitialState(),this.draw(),this.start(),this.setupClickHandler()}saveInitialState(){this.initialGrid=this.grid.map(t=>[...t])}reset(){this.stop(),this.grid=this.initialGrid.map(t=>[...t]),this.draw(),this.start()}setupClickHandler(){this.canvas.addEventListener("click",t=>{let e=this.canvas.getBoundingClientRect(),s=t.clientX-e.left,i=t.clientY-e.top,r=Math.floor(s/this.cellSize),l=Math.floor(i/this.cellSize);l>=0&&l<this.rows&&r>=0&&r<this.cols&&(this.grid[l][r]=this.grid[l][r]===1?0:1,this.draw())})}setupResizeObserver(){this.resizeObserver=new ResizeObserver(()=>{this.updateDimensions(),this.draw()}),this.canvas.parentElement&&this.resizeObserver.observe(this.canvas.parentElement)}updateDimensions(){let t=this.canvas.parentElement;if(!t)return;let e=t.clientWidth,s=Math.ceil(e/this.cellSize);if(Math.abs(s-this.cols)>1){let i=this.grid;this.cols=s,i.length>0?this.preserveGridState(i):this.initializeGrid()}this.canvas.width=this.cols*this.cellSize,this.canvas.height=this.rows*this.cellSize}preserveGridState(t){let e=[];for(let s=0;s<this.rows;s++){e[s]=[];for(let i=0;i<this.cols;i++)e[s][i]=t[s]&&t[s][i]||0}this.grid=e}initializeGrid(){this.grid=[];for(let i=0;i<this.rows;i++){this.grid[i]=[];for(let r=0;r<this.cols;r++)this.grid[i][r]=0}let t=this.config.initialState,e=this.config.verticalPadding,s=Math.floor((this.cols-t[0].length)/2);for(let i=0;i<t.length;i++)for(let r=0;r<t[i].length;r++){let l=e+i,n=s+r;l>=0&&l<this.rows&&n>=0&&n<this.cols&&(this.grid[l][n]=t[i][r])}}countNeighbors(t,e){let s=0;for(let i=-1;i<=1;i++)for(let r=-1;r<=1;r++){if(i===0&&r===0)continue;let l=t+i,n=e+r;l>=0&&l<this.rows&&n>=0&&n<this.cols&&(s+=this.grid[l][n])}return s}update(){let t=[];for(let e=0;e<this.rows;e++){t[e]=[];for(let s=0;s<this.cols;s++){let i=this.countNeighbors(e,s);this.grid[e][s]===1?t[e][s]=i===2||i===3?1:0:t[e][s]=i===3?1:0}}this.grid=t}draw(){this.ctx.fillStyle="#ffffff",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.ctx.strokeStyle="#e0e0e0",this.ctx.lineWidth=1;for(let t=0;t<=this.cols;t++){let e=t*this.cellSize;this.ctx.beginPath(),this.ctx.moveTo(e,0),this.ctx.lineTo(e,this.canvas.height),this.ctx.stroke()}for(let t=0;t<=this.rows;t++){let e=t*this.cellSize;this.ctx.beginPath(),this.ctx.moveTo(0,e),this.ctx.lineTo(this.canvas.width,e),this.ctx.stroke()}this.ctx.fillStyle="#000000";for(let t=0;t<this.rows;t++)for(let e=0;e<this.cols;e++)this.grid[t][e]===1&&this.ctx.fillRect(e*this.cellSize+1,t*this.cellSize+1,this.cellSize-2,this.cellSize-2)}start(){let t=this.config.secondsPerFrame*1e3;this.intervalId=window.setInterval(()=>{this.update(),this.draw()},t)}stop(){this.intervalId!==null&&(clearInterval(this.intervalId),this.intervalId=null),this.resizeObserver&&(this.resizeObserver.disconnect(),this.resizeObserver=null)}},h=c({selector:".widget-game-of-life",initialize:t=>{let e=t.querySelector(".game-of-life-canvas");if(!e)return;let s=t.getAttribute("data-config");if(!s)return;let i;try{i=JSON.parse(s)}catch(n){console.error("Failed to parse game-of-life config:",n);return}let r=new a(e,i),l=t.querySelector(".game-of-life-refresh");if(l){let n=()=>r.reset();return l.addEventListener("click",n),()=>{r.stop(),l.removeEventListener("click",n)}}return()=>{r.stop()}}});h.start();
